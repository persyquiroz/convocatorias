import{a as ce,b as ge,c as Ie,d as ze}from"./chunk-OQU72O37.js";import{a as we}from"./chunk-IFCPBNVN.js";import{a as Me,b as ye,e as Te}from"./chunk-MSUIWGPM.js";import{a as pe,b as de}from"./chunk-B7BMMS55.js";import"./chunk-YGXECBOZ.js";import{a as Fe}from"./chunk-FGBMNMAF.js";import{a as le,d as me,e as se,f as ue,g as fe,h as _e,i as he,j as ve,k as Ce,l as Se,m as Ee}from"./chunk-2ROHVELT.js";import"./chunk-6IZRV72R.js";import{l as be,m as xe}from"./chunk-QCTLU5KR.js";import{$ as re,U as ne,Z as oe,a as W,d as X,e as Y,g as Z,h as ee,i as te,j as ie,k as ae}from"./chunk-5AL6BP45.js";import"./chunk-IX6G3U3V.js";import"./chunk-PBBC5T5L.js";import{i as U,k as q,l as J,m as K,n as Q}from"./chunk-XKBAUKFN.js";import{Ea as E,Eb as u,Fa as T,I as $,Ib as V,Jb as N,Kc as H,Lb as l,Qb as I,Rb as b,Tb as x,Ub as M,Vb as t,Wb as i,Xb as h,Z as P,Zb as z,aa as D,cc as c,ec as v,g as S,hb as R,hc as j,j as F,mb as r,oa as g,pc as a,q as k,qc as d,rc as w,tc as L,ua as B,uc as O,v as y,vc as A,wc as f,xc as C,yc as G}from"./chunk-XIX3ZHYF.js";var ke=()=>[2,4,10,25,100,500,1e3,2e3];function $e(n,s){n&1&&(h(0,"mat-progress-spinner",26),t(1,"div",27),a(2,"Sincronizando..."),i())}function Pe(n,s){if(n&1&&(t(0,"mat-option",13),a(1),i()),n&2){let e=s.$implicit;l("value",e.id),r(),d(e.nombre)}}function De(n,s){if(n&1&&(t(0,"mat-option",13),a(1),i()),n&2){let e=s.$implicit;l("value",e.id),r(),d(e.nombre)}}function Be(n,s){n&1&&h(0,"mat-progress-bar",28)}function Re(n,s){if(n&1&&h(0,"img",32),n&2){let e=v().$implicit;l("src",e.entidad_logo_url,R)}}function Ve(n,s){n&1&&h(0,"img",33)}function Ne(n,s){if(n&1&&a(0),n&2){let e=v().$implicit;w(" (",e.entidad_siglas,") ")}}function je(n,s){if(n&1){let e=z();t(0,"tr",24)(1,"td",29),a(2),i(),t(3,"td"),a(4),i(),t(5,"td",29),u(6,Re,1,1)(7,Ve,1,0),V(8,6,null,null,7),N(),i(),t(10,"td"),a(11),u(12,Ne,1,1),i(),t(13,"td"),a(14),i(),t(15,"td",30),a(16),f(17,"number"),i(),t(18,"td",29),a(19),f(20,"date"),i(),t(21,"td"),a(22),i(),t(23,"td",29)(24,"a",31),c("click",function(){let o=E(e).$implicit,p=v();return T(p.verMas(o))}),a(25,"Ver m\xE1s"),i()()()}if(n&2){let e=s.$implicit,m=s.$index;r(2),d(m+1),r(2),d(e.carrera_nombre),r(7),w("",e.entidad_nombre," "),r(),I(e.entidad_nombre!=e.entidad_siglas?12:-1),r(2),d(e.cargo),r(2),d(C(17,8,e.sueldo)),r(3),d(G(20,10,e.fecha,"dd/MM/yyyy")),r(3),d(e.lugar_nombre)}}function Le(n,s){if(n&1){let e=z();t(0,"div")(1,"mat-paginator",34),c("page",function(o){E(e);let p=v();return T(p.changePage(o))}),i()()}if(n&2){let e=s.ngIf;r(),j("pageIndex",e.current_page-1),l("length",e.total)("pageSize",e.page_size)("pageSizeOptions",A(4,ke))}}var bt=(()=>{class n{changeDetectionRef=g(H);convocatorias$=new S;convocatoriaService=g(we);carreraService=g(Fe);pagination$=new S;paging={search:"",page_size:10,last_page:1,current_page:1,ordering:"carrera__nombre,-sueldo,entidad__nombre"};cargado=!1;dialog=g(Te);sincronizando=!1;sueldos=[{id:"0-2000",nombre:"Hasta 2000"},{id:"2000-4000",nombre:"De 2000 a 4000"},{id:"4000-6000",nombre:"De 4000 a 6000"},{id:"6000-8000",nombre:"De 6000 a 8000"},{id:"8000-",nombre:"De 8000 a m\xE1s"}];formBuilder=g(ie);myform=this.formBuilder.group({entidad_id:["T",[]],carrera_id:["T",[]],sueldo:[this.sueldos[3].id,[]],search:["",[]]});carreras$=new S;$subject=new F;ngOnInit(){this.getCarreras(),this.listar(),this.$subject.pipe($(500)).subscribe(e=>this.listarPor())}getCarreras(){this.carreras$=this.carreraService.search().pipe(y(e=>e))}listar(){this.cargado=!1;let e=this.myform.value;if(delete this.paging.sueldo__gte,delete this.paging.sueldo__lte,e.sueldo!="T"){let o=e.sueldo.split("-");o[0]&&(this.paging.sueldo__gte=o[0]),o[1]&&(this.paging.sueldo__lte=o[1])}e.carrera_id!="T"?this.paging.carrera_id=e.carrera_id:delete this.paging.carrera_id,this.paging.search=e.search.trim();let m=this.convocatoriaService.listadoPag(this.paging).pipe(P(1));this.convocatorias$=m.pipe(D(o=>(this.cargado=!0,k(o.data)))),this.pagination$=m.pipe(y(o=>o.pagination)),this.changeDetectionRef.markForCheck()}changePage(e){console.log("e: ",e),this.paging.page_size!=e.pageSize?(this.paging.page_size=e.pageSize,this.paging.current_page=1):(this.paging.page_size=e.pageSize,this.paging.current_page=e.pageIndex+1),this.listar()}sincronizar(e,m){this.dialog.open(Ie,{width:"250px",data:{titulo:"Sincronizar",mensaje:"\xBFEst\xE1 seguro de sincronizar las convocatorias?"},enterAnimationDuration:e,exitAnimationDuration:m}).afterClosed().subscribe(p=>{p&&this.sincronConfirm()})}sincronConfirm(){this.sincronizando=!0,this.convocatoriaService.sincronizar().subscribe({next:e=>{this.sincronizando=!1,this.listar()},error:e=>{console.error("Error:",e),this.sincronizando=!1}}),this.changeDetectionRef.markForCheck()}changeSelect(e){this.listarPor()}verMas(e){this.dialog.open(ze,{width:"100vw",height:"100vh",panelClass:"fullscreen-dialog",hasBackdrop:!0,data:e}).afterClosed().subscribe(o=>{})}listarPor(){this.paging.current_page=1,this.listar()}listarTime(e){this.$subject.next("")}static \u0275fac=function(m){return new(m||n)};static \u0275cmp=B({type:n,selectors:[["app-convocatorias"]],standalone:!0,features:[L([{provide:ve,useClass:Ee}]),O],decls:72,vars:17,consts:[[1,"card-titulo","p-3"],[1,"mb-0"],[1,"m-0"],[1,"p-3"],["autocomplete","off","spellcheck","true",2,"display","contents",3,"formGroup"],[1,"row"],[1,"col-12","col-sm-4","mb-3","mb-sm-0"],[1,"mb-2","d-flex"],["mat-mini-fab","","aria-label","Actualizar","matTooltip","Actualizar",3,"click"],["mat-mini-fab","","aria-label","Sincron","matTooltip","Sincronizar",1,"ms-2",3,"click","disabled"],[1,"col-12","col-sm-3"],["appearance","outline",2,"display","flex"],["formControlName","carrera_id",3,"ngModelChange"],[1,"select-min",3,"value"],[1,"col-12","col-sm-2"],[2,"padding-left","2px"],["formControlName","sueldo",3,"ngModelChange"],["appearance","outline","floatLabel","always",2,"display","flex"],["matInput","","formControlName","search",3,"keyup"],["mode","indeterminate",4,"ngIf"],[1,"table-responsive"],["width","100%",1,"basic","table-bordered","table-color","txt-12"],[1,"bg-eee"],[3,"width"],[1,"tr_color_yellow"],[4,"ngIf"],["mode","indeterminate","diameter","30",1,"ms-2","mt-1"],[1,"ms-1","pt-2"],["mode","indeterminate"],["align","center"],["align","right"],[1,"an-link",3,"click"],[1,"logo-entidad",3,"src"],["src","logo-entidad.png",1,"logo-entidad"],["showFirstLastButtons","","aria-label","Select page",3,"page","length","pageSize","pageIndex","pageSizeOptions"]],template:function(m,o){m&1&&(t(0,"div",0)(1,"h4",1),a(2,"Convocatorias vigentes"),i(),t(3,"p",2),a(4,"Listado de convocatorias"),i()(),t(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"button",8),c("click",function(){return o.listar()}),t(11,"mat-icon"),a(12,"refresh"),i()(),t(13,"button",9),c("click",function(){return o.sincronizar("5ms","0ms")}),t(14,"mat-icon"),a(15,"sync_alt"),i()(),u(16,$e,3,0),i()(),t(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),a(20,"Profesi\xF3n / Carrera"),i(),t(21,"mat-select",12),c("ngModelChange",function(_){return o.changeSelect(_)}),t(22,"mat-option",13),a(23,"Todas"),i(),x(24,Pe,2,2,"mat-option",13,b),f(26,"async"),i()()(),t(27,"div",14)(28,"div",15)(29,"mat-form-field",11)(30,"mat-label"),a(31,"Sueldo"),i(),t(32,"mat-select",16),c("ngModelChange",function(_){return o.changeSelect(_)}),t(33,"mat-option",13),a(34,"Todos"),i(),x(35,De,2,2,"mat-option",13,b),i()()()(),t(37,"div",10)(38,"div",15)(39,"mat-form-field",17)(40,"mat-label"),a(41,"Buscar por entidad o cargo"),i(),t(42,"input",18),c("keyup",function(_){return o.listarTime(_)}),i()()()()()(),u(43,Be,1,0,"mat-progress-bar",19),t(44,"div",20)(45,"table",21)(46,"thead")(47,"tr",22)(48,"th",23),a(49,"#"),i(),t(50,"th"),a(51,"Carrera"),i(),t(52,"th",23),a(53,"Logo"),i(),t(54,"th"),a(55,"Entidad"),i(),t(56,"th"),a(57,"Cargo"),i(),t(58,"th"),a(59,"Sueldo"),i(),t(60,"th",23),a(61,"Fecha"),i(),t(62,"th"),a(63,"Lugar"),i(),t(64,"th",23),a(65,"Ver m\xE1s"),i()()(),t(66,"tbody"),x(67,je,26,13,"tr",24,b),f(69,"async"),i()()(),u(70,Le,2,5,"div",25),f(71,"async"),i()),m&2&&(r(6),l("formGroup",o.myform),r(7),l("disabled",o.sincronizando),r(3),I(o.sincronizando?16:-1),r(6),l("value","T"),r(2),M(C(26,11,o.carreras$)),r(9),l("value","T"),r(2),M(o.sueldos),r(8),l("ngIf",!o.cargado),r(5),l("width",25),r(4),l("width",50),r(8),l("width",65),r(4),l("width",50),r(3),M(C(69,13,o.convocatorias$)),r(3),l("ngIf",C(71,15,o.pagination$)))},dependencies:[q,Se,Ce,Q,U,K,J,xe,be,re,oe,de,pe,he,_e,ye,Me,ae,Z,W,X,Y,ee,te,se,me,le,fe,ue,ne,ge,ce],changeDetection:0})}return n})();export{bt as ConvocatoriasComponent};
